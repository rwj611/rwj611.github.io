---
layout:     post
title:      "词向量之ELMO"
subtitle:   ""
date:       2020-11-10 12:00:00
author:     "rwj611"
header-img: "img/post-bg-2015.jpg"
catalog: true
tags:
    - ai
---

<head>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    </script>
</head>

#### 1. word embedding缺点
不能处理同义词


#### 2. 双向语言模型(BiLM)
给定N个token的序列: ($ t_1,t_2,t_3,t_4,...,t_N $)

前向语言模型:
$ p(t_1,t_2,t_3,...,t_N) = \prod_{k=1}^Np(t_k|t_1,t_2,...,t_{k-1}) $

后向语言模型:
$ p(t_1,t_2,t_3,...,t_N) = \prod_{k=1}^Np(t_k|t_{k+1},t_{k+2},...,t_N) $

前向语言模型预测$t_{k+1}$:
1. 首先计算上下文无关的token表示 $X_k^{LM}$ 
2. 将之传递通过前向LSTM的L层
3. 对于每个位置k, LSTM输出上下文相关的表示$\stackrel{\rightarrow}{h}_{k,j}^{LM}$, j=1,2,3,...,L; LSTM最上层输出$\stackrel{\rightarrow}{h}_{k,L}^{LM}$
4. 然后再接一层softmax预测$t_{k+1}$的值
后向语言模型预测$t_k$:
同前向预测$t_{k+1}$, 通过$\stackrel{\leftarrow}{h}_{k,j}^{LM}$预测$t_k$

input:原始的词向量 $x_k^{LM}$, 由字符卷积获取
![avatar][charcnn]

BiLM结合了前后向，极大似然估计：
$ \sum_{k=1}^N( \logp(t_k|t_1,t_2,...,t_{k-1};\Theta_x,\stackrel{\rightarrow}{\Theta}_{LSTM},\Theta_s) + \logp(t_k|t_{k+1},t_{k+2},...,t_N;\Theta_x,\stackrel{\leftarrow}{\Theta}_{LSTM},\Theta_s))  $




[charcnn]:data:image/png;base64,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
